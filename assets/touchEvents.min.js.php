<?php

/*
 * Touch Events JS package for Bear Framework
 * https://github.com/ivopetkov/touch-events-js-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */

return <<<'EOT'
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.touchEvents=ivoPetkov.bearFrameworkAddons.touchEvents||function(){var n=()=>{if(void 0!==EventTarget&&void 0!==EventTarget.constructor)try{return new EventTarget}catch(n){}var n=[];return{addEventListener:(e,t)=>{e in n||(n[e]=[]),n[e].push(t)},removeEventListener:(e,t)=>{if(e in n)for(var r=n[e],i=0,v=r.length;i<v;i++)if(r[i]===t)return void r.splice(i,1)},dispatchEvent:e=>{if(!(e.type in n))return!0;for(var t=n[e.type].slice(),r=0,i=t.length;r<i;r++)t[r].call(this,e);return!e.defaultPrevented}}},e=function(n,e){var t=n.clientX,r=n.clientY,i=e.clientX,v=e.clientY;return Math.round(Math.sqrt(Math.pow(Math.abs(i-t),2)+Math.pow(Math.abs(v-r),2)))};return{addZoom:function(t,r){void 0===r&&(r=t),r.addEventListener("touchstart",(function(n){n.preventDefault()}),{passive:!1});var i=n(),v=[],o=null,a=1,d=function(n){for(var e in v){v[e].downEvent.pointerId===n.pointerId&&(v.splice(e,1),1===v.length&&(t=void 0,(t=new Event("end")).change=a,i.dispatchEvent(t)))}var t};return t.addEventListener("pointerdown",(function(n){for(var t in v)if(v[t].downEvent.pointerId===n.pointerId)return;v.push({downEvent:n,moveEvent:n}),2===v.length&&function(){for(var n=0;n<v.length;n++){var t=v[n];t.downEvent=t.moveEvent}o=e(v[0].downEvent,v[1].downEvent);var r=new Event("start");i.dispatchEvent(r)}()})),r.addEventListener("pointermove",(function(n){if(2===v.length){for(var t=0;t<2;t++){var r=v[t];r.downEvent.pointerId===n.pointerId&&(r.moveEvent=n)}var d=e(v[0].moveEvent,v[1].moveEvent);a=d/o;var c=new Event("change");c.change=a,i.dispatchEvent(c)}})),r.addEventListener("pointerup",d),r.addEventListener("pointercancel",d),r.addEventListener("pointerout",d),r.addEventListener("pointerleave",d),i},addMove:function(e,t){void 0===t&&(t=e),t.addEventListener("touchstart",(function(n){n.preventDefault()}),{passive:!1});var r=n(),i=[],v=[0,0],o=[0,0],a=function(n){var e=i.length;if(1===e){var t=n?i[0].downEvent:i[0].moveEvent;return[t.clientX,t.clientY]}if(e>1){var r=n?i[0].downEvent:i[0].moveEvent,v=n?i[1].downEvent:i[1].moveEvent;return[r.clientX-(r.clientX-v.clientX)/2,r.clientY-(r.clientY-v.clientY)/2]}return[0,0]},d=function(){v=a(!0);var n=new Event("start");r.dispatchEvent(n)},c=function(){var n=new Event("end");n.changeX=o[0],n.changeY=o[1],r.dispatchEvent(n),o=[0,0];for(var e=0;e<i.length;e++){var t=i[e];t.downEvent=t.moveEvent}},E=function(n){for(var e in i){i[e].downEvent.pointerId===n.pointerId&&(i.splice(e,1),c(),i.length>0&&d())}};return e.addEventListener("pointerdown",(function(n){for(var e in i)if(i[e].downEvent.pointerId===n.pointerId)return;i.push({downEvent:n,moveEvent:n}),i.length>1&&c(),d()})),t.addEventListener("pointermove",(function(n){for(var e=0;e<i.length;e++){var t=i[e];t.downEvent.pointerId===n.pointerId&&(t.moveEvent=n)}if(0!==i.length){var d=a(!1);o=[Math.round(d[0]-v[0]),Math.round(d[1]-v[1])];var c=new Event("change");c.changeX=o[0],c.changeY=o[1],r.dispatchEvent(c)}})),t.addEventListener("pointerup",E),t.addEventListener("pointercancel",E),t.addEventListener("pointerout",E),t.addEventListener("pointerleave",E),r},addDoubleTap:function(e){var t=n(),r=[],i=[];return e.addEventListener("pointerdown",(function(n){for(var e in r)if(r[e].pointerId===n.pointerId)return;r.push(n),1===r.length&&i.push([0,(new Date).getTime()])})),e.addEventListener("pointerup",(function(n){for(var e in r){if(r[e].pointerId===n.pointerId&&(r.splice(e,1),0===r.length)){i.push([1,(new Date).getTime()]);var v=i.length-4;if(v<0&&(v=0),4===(i=i.slice(v)).length){for(var o=0,a=1;a<=i.length;a++)o+=a*i[a-1][0];if(6===o&&i[3][1]-i[0][1]<500){var d=new Event("done");t.dispatchEvent(d)}}}}})),t},addSwipe:function(e,t){void 0===t&&(t=e),e.addEventListener("touchstart",(function(n){n.preventDefault()}),{passive:!1});var r=n(),i=[],v=[0,0,null],o=null,a=function(n){for(var e in i){if(i[e].downEvent.pointerId===n.pointerId){i.splice(e,1);var t=new Event("end");t.changeX=v[0],t.changeY=v[1],t.direction=v[2],r.dispatchEvent(t),v=[0,0,null],o=null}}};return e.addEventListener("pointerdown",(function(n){if(1!==i.length){for(var e in i)if(i[e].downEvent.pointerId===n.pointerId)return;i.push({downEvent:n,moveEvent:n}),o=!1}})),t.addEventListener("pointermove",(function(n){for(var e=0;e<i.length;e++){var t=i[e];t.downEvent.pointerId===n.pointerId&&(t.moveEvent=n)}if(0!==i.length){if(!1===o){var a=new Event("start");r.dispatchEvent(a),o=!0}var d=i[0],c=d.moveEvent.clientX-d.downEvent.clientX,E=d.moveEvent.clientY-d.downEvent.clientY,p=null;p=Math.abs(c)>Math.abs(E)?c<0?"left":"right":E<0?"up":"down",(a=new Event("change")).changeX=c,a.changeY=E,a.direction=p,r.dispatchEvent(a),v=[c,E,p]}})),t.addEventListener("pointerup",a),t.addEventListener("pointercancel",a),t.addEventListener("pointerout",(function(n){(function(n,e){if(null!==e&&null!==n)for(var t=e.parentNode;null!==t;){if(t===n)return!0;t=t.parentNode}return!1})(t,n.target)||a(n)})),t.addEventListener("pointerleave",a),r}}}();
EOT;
